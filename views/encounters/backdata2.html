<html>
<head>
        
<script type="text/javascript" src="/public/touchscreentoolkit/lib/javascripts/touchScreenToolkit.js" defer="true"></script>
<script type="text/javascript" src="/public/touchscreentoolkit/lib/javascripts/standard.js" defer="true"></script>
<link rel="stylesheet" type="text/css" href="../../../../assets/css/bootstrap/bootstrap.min.css">

<script type="text/javascript" src="/assets/js/yes_no_ctrls.js"></script>
<link rel="stylesheet" href="/assets/css/yes_no_ctrls.css" type="text/css">
<script type="text/javascript" src="/assets/js/post_parameters.js"></script>
<script type="text/javascript" src="/assets/js/generic_ajaxrequest.js"></script>
<script type="text/javascript" src="/assets/js/alertifyjs/alertify.js"></script>
<script type="text/javascript" src="/assets/js/does_connection_exist.js"></script>
<script type="text/javascript" src="/assets/js/moment.js"></script>
<script type="text/javascript" src="/apps/HTS/assets/js/common.js"></script>
<script type="text/javascript" src="/apps/HTS/assets/js/elements.js"></script>
<script src="../../../../assets/js/jquery.min.js"></script>
<script type="text/javascript" src="/apps/HTS/assets/js/backdata2.js"></script>
<script type="text/javascript" src="../../../../../htsV2/client-src/src/components/backdataEntry.js"></script>
<link rel="stylesheet" href="/assets/css/alertifyjs/css/alertify.css" type="text/css">
<link rel="stylesheet" type="text/css" href="../../../../assets/css/datatables/jquery.dataTables.min.css">
<link rel="stylesheet" type="text/css" href="../../../../assets/css/datatables/fixedHeader.dataTables.min.css">

<link rel="stylesheet" href="/assets/css/maindashboard/footer.css">
<link rel="stylesheet" href="/apps/HTS/assets/css/backdata.css" type="text/css">

<script>


</script>
<style>
    * {
    -webkit-box-sizing: content-box;
    -moz-box-sizing: content-box;
    box-sizing:content-box;
}
    .main{
        width: 1000%;
    }
    
    
        .btn-yellow {
        min-height: 40px;
        margin: 0px;
            margin-bottom: 0px;
        margin-bottom: 5px;
        font-size: 1.2em;
        background-color: #ffc579;
        color: #FFF;
        font-weight: normal;
        border: 5px outset #000;
        padding: 9px;
        cursor: pointer;
        background: url(/assets/images/btn_yellow.png) right repeat;
        -moz-user-select: none;
        -moz-user-focus: disabled;
        border-radius: 12px;
        pointer-events: none;
    }
    /* .td {
      border: 1px solid black;
    } */
    .deleteHeader{
        padding: 5px;

        color: white;

        background-color: rgb(52, 92, 180);

        border: 2px outset rgb(52, 92, 180);

        border-top-left-radius: 8px;

        border-top-right-radius: 8px;

        font-size: 28px;
    }
    .deleteTitle{
        font-size: 18px;

        text-align: center;

        font-weight: 600;
    }
    .deleteBody{
        font-size: 20px;

        text-align: center;

        font-weight: 400;
    }
    table {
    width: 100%;
    height: 100%;
     margin: auto;
      border-collapse: collapse;
      display: block;
      
    }
    .button {
    font-size: 18px !important;
    min-width: 60px;
    cursor: pointer;
    min-height: 55px;
    border-radius: 5px !important;
    margin: 3px;
    border: 1px solid #7eb9d0;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    font-family: arial,helvetica,sans-serif;
    padding: 10px;
    text-decoration: none;
    display: inline-block;
    text-shadow: -1px -1px 0 rgba(0,0,0,.3);
    font-weight: 700;
    color: #fff;
    background-color: #a7cfdf;
    background-image: -webkit-gradient(linear,left top,left bottom,from(#a7cfdf),to(#23538a));
    background-image: -webkit-linear-gradient(top,#a7cfdf,#23538a);
    background-image: -o-linear-gradient(top,#a7cfdf,#23538a);
    background-image: linear-gradient(180deg,#a7cfdf,#23538a);
    filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#a7cfdf,endColorstr=#23538a);
}
    
    
    td:first-of-type, th:first-of-type {
      border-left: none;
    }
    
    td:last-of-type, th:last-of-type {
      border-right: none;
    }
    .inputFrameClass {
        width: 2000% !important;
        overflow-x: scroll;
    }
    #content {
    background: #FFFFFF;
    position: absolute;
    left: 0%;
    top: 0%;
    width: 300%;
    height: 750px;
    margin-left: 0.5%;
    margin-right: 0.5%;
    margin-top: -380px;
    overflow: auto;
}
div.dataTables_wrapper {
        width: 10000px;
        margin: 0 auto;
    }
    .bdeSectionHeader {
    background-color: #c50000;
    color: #fff;
    font-weight: 700;
    padding: 5px;
    font-size: 14px;
    width: 4145px;
}
#back {
    min-width: 140px;
  }
  .popup-overlay{
  /*Hides pop-up when there is no "active" class*/
  visibility:hidden;
  position:absolute;
  background:#ffffff;
  border:3px solid #666666;
  width:50%;
  height:50%;
  left:25%; 
}
.popup-overlay.active{
  /*displays pop-up when "active" class is present*/
  visibility:visible;
  text-align:center;
}

.popup-content {
  /*Hides pop-up content when there is no "active" class */
 visibility:hidden;
}

.popup-content.active {
  /*Shows pop-up content when "active" class is present */
  visibility:visible;
}
.btnDelete,.btnDelete:hover {
    margin-bottom: 5px;
    font-size: 1.2em;
    background-color: #6281a7;
    color: #FFF;
    font-weight: normal;
    padding: 9px;
    cursor: pointer;
    background: #305f92;
    -moz-user-select: none;
    -moz-user-focus: disabled;
    border-radius: 12px;
    }
.btnClose {
    margin-bottom: 5px;
    font-size: 1.2em;
    background-color: #6281a7;
    color: #FFF;
    font-weight: normal;
    padding: 9px;
    cursor: pointer;
    background: #c50000;
    -moz-user-select: none;
    -moz-user-focus: disabled;
    border-radius: 12px;
    }
    .btnClose:hover {

    background-color: #600909;
    background: #600909;
    }
    .btnDelete:hover {
    background: #23466c;

    }
.validHeader{
    padding: 5px;

    color: white;

    background-color: #c50000;

    border: 2px outset#c50000;

    border-top-left-radius: 8px;

    border-top-right-radius: 8px;

    font-size: 28px;
}
.validTitle{
        font-size: 18px;

        text-align: center;

        font-weight: 600;
    }
    .validBody{
        font-size: 18px;

        text-align: center;

        font-weight: 400;
    }
 </style>
<style media="save">
        button {
            display: none;
        }
        #main {
            height: 100%;
}  </style>

        
</head>
<body id="mateme" onload="addRow();">
<div id="container">
    <div id="content" class="main" style="width:100%; overflow-x: scroll;height: 735px;">
   <div class="mainContainer">
        <div class="bdeSectionHeader">Backdata Entry</div>

       <table width = "100%">
            <tbody>
               <tr>
                   <td> 
                        <div id="bdScroller" style="width: calc(-200px + 100vw); border-right: 1px solid rgb(51, 51, 51); height: calc(-260px + 100vh); overflow-x:scroll; overflow-y: hidden;padding: 0px;">
                                <table id="backdata" cellpadding="5px;" style="width:250%">
                                        <tr>
                                            <th rowspan="4" style="border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); vertical-align: top; height: 50px;" class="boldRight">
                                                Entry Code
                                            </th>
                                            <th rowspan="4" style="border-color: rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); width: 130px; vertical-align: top; font-size: 14px;" class="boldRight 0">Date
                                            </th>
                                            <th rowspan="4" style="border-color: rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight">
                                                HTS Provider ID
                                            </th>
                                            <th colspan="3" style="border-left: 1px solid rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight">
                                                Sex/Pregnancy
                                            </th>
                                            <th rowspan="4" style="border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight">
                                                Age
                                            </th>
                                            <th colspan="4" style="vertical-align: top; font-size: 14px;" class="boldRight">
                                                Age Group
                                            </th>
                                            <th colspan="3" style="border-left: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight">
                                                HTS Access Type
                                            </th>
                                            <th colspan="5" style="border-left: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="">
                                                Last HIV Test
                                            </th>
                                            <td rowspan="4" style="border-bottom: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight"><b>
                                            Time<br>Since Last<br>Test</b><br><br>
                                            <span style="font-size: 12px;">No.of<br>Days<br>Weeks<br>Months or<br>Years</span>
                                            </td>
                                            <td colspan="2" style="border-right: 1px solid rgb(51, 51, 51); border-left: 1px solid rgb(51, 51, 51); width: 30px; height: 50px; vertical-align: top; text-align: center; font-size: 14px;" class="boldRight"><b>Partner Present</b><br><span style="font-size: 11px;">at this session</span>
                                            </td>
                                            <th colspan="8" style="border-left: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight">
                                            HIV Rapid Test Outcomes
                                            </th>
                                            <th colspan="5" style="border-left: 1px solid rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight">
                                            Outcome Summary
                                            </th>
                                            <th colspan="6" style="vertical-align: top; font-size: 14px;" class="boldRight">
                                            Result Given to Client
                                            </th>
                                            <th colspan="4" rowspan="2" style="border-left: 1px solid rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight">
                                            Partner HIV Status
                                            </th>
                                            <th colspan="4" rowspan="2" style="border-left: 1px solid rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight">
                                            Client Risk Category
                                            </th>
                                            <th colspan="4" rowspan="2" style="padding: 10px; border-left: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight 13">
                                            Referral for Re - Testing
                                            </th>
                                            <th colspan="3" style="padding: 10px; border-left: 1px solid rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 14px;" class="boldRight">
                                            Number of Items<br>Given
                                            </th>
                                            <th colspan = "6" style="padding: 10px; border-right: 1px solid rgb(51, 51, 51); vertical-align: top; border-left: 1px solid rgb(51, 51, 51); font-size: 14px; width:300px" class="boldRight">
                                            Comments
                                            </th>
                                        </tr>
                                        <tr>
                                            <td rowspan="3" class="td" style="border-left: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); height: 70px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">
                                                    Male
                                                    </div>
                                                </div>
                                        </td>
                                            <td rowspan="3" class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 100px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">
                                                Female<i style="color: rgb(255, 255, 255);">_</i>Non-Preg.
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-right: 3px solid rgb(0, 0, 0); border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 100px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">
                                                    Female<i style="color: rgb(255, 255, 255);">_</i>Pregnant
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-left: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 100px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">0 - 11
                                                        <i style="color: rgb(255, 255, 255);">_</i>months
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">1 - 14
                                                        <i style="color: rgb(255, 255, 255);">_</i>years
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">15 - 24
                                                        <i style="color: rgb(255, 255, 255);">_</i>years
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td boldRight"  style="border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">25 +
                                                        <i style="color: rgb(255, 255, 255);">_</i>years
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-left: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 34px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -85px;">Routine
                                                        <i style="color: rgb(255, 255, 255);">_</i>HTS
                                                        <i style="color: rgb(255, 255, 255);">_</i>within Health
                                                        <i style="color: rgb(255, 255, 255);">_</i>Service
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -85px;">Comes
                                                        <i style="color: rgb(255, 255, 255);">_</i>with
                                                        <i style="color: rgb(255, 255, 255);">_</i>HTS Family
                                                        <i style="color: rgb(255, 255, 255);">_</i>Ref.
                                                        <i style="color: rgb(255, 255, 255);">_</i>Slip
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td boldRight"  style="border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 15px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">Other
                                                        <i style="color: rgb(255, 255, 255);">_</i>(VCT,etc.)
                                                        <i style="color: rgb(255, 255, 255);">________________________</i>
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-left: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">Never Tested
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">Last Negative
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">Last Positive
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 45px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -85px;">Last
                                                        <i style="color: rgb(255, 255, 255);">_</i>Expos.
                                                        <i style="color: rgb(255, 255, 255);">_</i>Infant
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">Last Inconclusive
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td"  style="border-left: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">No
                                                    </div>
                                                </div>
                                            </td>
                                            <td rowspan="3" class="td boldRight"  style="border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); width: 30px; height: 50px;" class="boldRight">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -100px;">Yes
                                                    </div>
                                                </div>
                                            </td>
                                            <td colspan="8" class="td boldRight"  style="border-right: 1px solid rgb(51, 51, 51);" class="boldRight"></td>
                                            <td colspan="2" class="td"  style="font-size: 12px; text-align: center;" class="boldRight">Only Test 1 used</td>
                                            <td colspan="3" class="td boldRight" style="border-right: 1px solid rgb(51, 51, 51); font-size: 12px; text-align: center;" class="boldRight">Test 1 &amp; Test 2
                                                <br>UsedÂ± Repeat
                                            </td>
                                            <td colspan="4" class="">&nbsp;
                                            </td>
                                            <td colspan="2" class="td"  style="border-right: 3px solid rgb(0, 0, 0); border-bottom: 1px dotted rgb(51, 51, 51); font-size: 12px; text-align: center; vertical-align: bottom;" class="boldRight">
                                                Confirmatory<br>Results for<br>Clients Last +</td>
                                            <td style="vertical-align: top; font-size: 12px;" class="14" align="center"><b>HTS<br>Family<br>Ref Slips</b></td>
                                            <td colspan="2" style="border-right: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 12px;" class="boldRight 14" align="center"><b>Condoms</b></td><td style="border-right: 3px solid rgb(0, 0, 0); vertical-align: top; font-size: 12px; text-align: center;" class="15"><i>Specimen ID for DBS<br>samples sent to lab.</i><br></td>
                                        </tr>
                                        <tr>
                                            <td colspan="4" class="td "  style="font-size: 12px; text-align: center; vertical-align: bottom;" class="8">First Pass
                                            </td>
                                            <td colspan="4" class="td boldRight"  style="border-right: 1px solid rgb(51, 51, 51); font-size: 12px; text-align: center; vertical-align: bottom;" class="boldRight">Immediate Repeat
                                            </td>
                                            <td class="td "  style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="9" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -89px;">Single
                                                        <i style="color: rgb(255, 255, 255);">_</i>Neg
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="9" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -95px;">Single
                                                        <i style="color: rgb(255, 255, 255);">_</i>Pos
                                                    </div>
                                                </div>
                                            </td>
                                            <td  class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="9" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">Test
                                                        <i style="color: rgb(255, 255, 255);">_</i>1&amp;2 
                                                        <i style="color: rgb(255, 255, 255);">_</i>Neg
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td "  style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="9" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">Test 
                                                        <i style="color: rgb(255, 255, 255);">_</i>1&amp;2 
                                                        <i style="color: rgb(255, 255, 255);">_</i>Pos
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td boldRight" style="border-bottom: 1px solid rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="boldRight 9" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">Test
                                                        <i style="color: rgb(255, 255, 255);">_</i>1&amp;2
                                                        <i style="color: rgb(255, 255, 255);">_</i>disc.
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td" style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="10" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -75px;">New
                                                        <i style="color: rgb(255, 255, 255);">_</i>Negative
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="10" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -85px;">New
                                                        <i style="color: rgb(255, 255, 255);">_</i>Positive
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="10" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -67px;">New
                                                        <i style="color: rgb(255, 255, 255);">_</i>Exp.
                                                        <i style="color: rgb(255, 255, 255);">_</i>Infant
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="10" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -67px;">New
                                                        <i style="color: rgb(255, 255, 255);">_</i>Inconclusive
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="10" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -80px;">Conf.
                                                        <i style="color: rgb(255, 255, 255);">_</i>Positive
                                                    </div>
                                                </div>
                                            </td>
                                        <td class="td boldRight" style="border-bottom: 1px solid rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px;" rowspan="2" class="boldRight 10" align="center">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -90px;">Inconclusive
                                                    </div>
                                                </div>
                                            </td>
                                            <td style="border-left: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="11">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">No Partner
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="11">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">HIV Unknown
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="11">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">Partner Neg.
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td boldRight"  style="border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">Partner Pos.
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="12">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">Low
                                                        <i style="color: rgb(255, 255, 255);">_</i>Risk
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="12">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">On - going
                                                        <i style="color: rgb(255, 255, 255);">_</i>Risk
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="12">
                                                <div style="height: 175px; font-size: 12px; width: 67px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -56px;">  High
                                                        <i style="color: rgb(255, 255, 255);">_</i>Risk
                                                        <i style="color: rgb(255, 255, 255);">_</i>Event
                                                        <i style="color: rgb(255, 255, 255);">_</i>in<br>last
                                                        <i style="color: rgb(255, 255, 255);">_</i>3
                                                        <i style="color: rgb(255, 255, 255);">_</i>months
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td boldRight" style="border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2">
                                                <div style="height: 160px; font-size: 12px; width: 50px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -57px;">Risk
                                                        <i style="color: rgb(255, 255, 255);">_</i>assessment<br>Not
                                                        <i style="color: rgb(255, 255, 255);">_</i>Done
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="13">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -55px;">No Re - Test needed
                                                    </div>
                                                </div>
                                            </td>
                                            <td style="border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="13">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -70px;">Re - Test
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="13">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -40px;">Confirmatory Test at HIV Clinic
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td boldRight" style="border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); font-size: 12px; vertical-align: bottom;" rowspan="2">Appointment<br>Date Given
                                            
                                            </td>
                                            <td class="td boldRight"  style="border-right: 1px solid rgb(51, 51, 51); border-bottom: 1px solid rgb(51, 51, 51); vertical-align: bottom; font-size: 12px;" rowspan="2" align="center"><i>1 Slip for each<br>partner + each<br>U5 child with<br>unk.status</i>
                                            </td>
                                            <td class="td"  style="border-bottom: 1px solid rgb(51, 51, 51);" rowspan="2" class="14">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -65px;">Male
                                                    </div>
                                                </div>
                                            </td>
                                            <td  class="td boldRight" style="border-bottom: 1px solid rgb(51, 51, 51); border-right: 1px solid rgb(51, 51, 51);" rowspan="2">
                                                <div style="height: 120px; font-size: 12px; width: 30px;">
                                                    <div style="transform: rotate(-90deg); transform-origin: right bottom 0px; margin-left: -65px;">Female
                                                    </div>
                                                </div>
                                            </td>
                                            <td  class="td"  style="border-right: 3px solid rgb(0, 0, 0); border-bottom: 1px solid rgb(51, 51, 51); vertical-align: top; font-size: 12px; text-align: center;" rowspan="2" class="15">
                                                <i>Follow - up outcome for<br>clients referred, etc.</i>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px; text-align: center;" colspan="2" class="8">Test 1</td>
                                            <td style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px; text-align: center;" colspan="2" class="8">Test 2</td>
                                            <td style="border-bottom: 1px solid rgb(51, 51, 51); font-style: italic; font-size: 12px; text-align: center;" colspan="2" class="8">Test 1</td>
                                            <td style="border-bottom: 1px solid rgb(51, 51, 51); border-right: 3px solid rgb(0, 0, 0); font-style: italic; font-size: 12px; text-align: center;" colspan="2" class="8">Test 2</td>
                                        </tr>
                                   <tr id="firstRow" style="cursor: pointer;"><td class="bdcell boldRight" style="width: 150px; color: rgb(197, 0, 0); font-size: 16px; text-align: center;"><span>&nbsp;</span></td><td id="cell0_0" class="bdcell boldRight "><div id="circle0_0" class="normal" style="color: rgb(197, 0, 0); font-size: 16px; text-align: center; width: 120px;"></div></td><td id="cell0_1" class="bdcell boldRight 1" style="background-color: rgba(200, 200, 200, 0.3);"><div id="circle0_1" class="normal" style="color: rgb(197, 0, 0); font-size: 16px; text-align: center;"></div></td><td id="cell0_2" class="bdcell 2"><div id="circle0_2" class="normal">M</div></td><td id="cell0_3" class="bdcell 2"><div id="circle0_3" class="normal">FNP</div></td><td id="cell0_4" class="bdcell boldRight 2"><div id="circle0_4" class="normal">FP</div></td><td id="cell0_5" class="bdcell boldRight 3"><div id="circle0_5" class="normal" style="color: rgb(197, 0, 0); font-size: 16px; text-align: center;"></div></td><td id="cell0_6" class="bdcell 4"><div id="circle0_6" class="normal">A</div></td><td id="cell0_7" class="bdcell 4"><div id="circle0_7" class="normal">B</div></td><td id="cell0_8" class="bdcell 4"><div id="circle0_8" class="normal">C</div></td><td id="cell0_9" class="bdcell boldRight 4"><div id="circle0_9" class="normal">D</div></td><td id="cell0_10" class="bdcell 5"><div id="circle0_10" class="normal">PITC</div></td><td id="cell0_11" class="bdcell 5"><div id="circle0_11" class="normal">FRS</div></td><td id="cell0_12" class="bdcell boldRight 5"><div id="circle0_12" class="normal">Oth</div></td><td id="cell0_13" class="bdcell 6"><div id="circle0_13" class="normal">LNev</div></td><td id="cell0_14" class="bdcell 6"><div id="circle0_14" class="normal">L-</div></td><td id="cell0_15" class="bdcell 6"><div id="circle0_15" class="normal">L+</div></td><td id="cell0_16" class="bdcell 6"><div id="circle0_16" class="normal">LEx</div></td><td id="cell0_17" class="bdcell boldRight 6"><div id="circle0_17" class="normal">LIn</div></td><td id="cell0_18" class="bdcell boldRight 6"><div id="circle0_18" class="normal" style="color: rgb(197, 0, 0); font-size: 16px; text-align: center;"></div></td><td id="cell0_19" class="bdcell 7"><div id="circle0_19" class="normal">N</div></td><td id="cell0_20" class="bdcell boldRight 7"><div id="circle0_20" class="normal">Y</div></td><td id="cell0_21" class="bdcell 8"><div id="circle0_21" class="normal">-</div></td><td id="cell0_22" class="bdcell boldRight 8"><div id="circle0_22" class="normal">+</div></td><td id="cell0_23" class="bdcell 8"><div id="circle0_23" class="normal">-</div></td><td id="cell0_24" class="bdcell boldRight 8"><div id="circle0_24" class="normal">+</div></td><td id="cell0_25" class="bdcell 8"><div id="circle0_25" class="normal">-</div></td><td id="cell0_26" class="bdcell boldRight 8"><div id="circle0_26" class="normal">+</div></td><td id="cell0_27" class="bdcell 8"><div id="circle0_27" class="normal">-</div></td><td id="cell0_28" class="bdcell boldRight 8"><div id="circle0_28" class="normal">+</div></td><td id="cell0_29" class="bdcell 9"><div id="circle0_29" class="normal">-</div></td><td id="cell0_30" class="bdcell 9"><div id="circle0_30" class="normal">+</div></td><td id="cell0_31" class="bdcell 9"><div id="circle0_31" class="normal">--</div></td><td id="cell0_32" class="bdcell 9"><div id="circle0_32" class="normal">++</div></td><td id="cell0_33" class="bdcell boldRight 9"><div id="circle0_33" class="normal">Disc</div></td><td id="cell0_34" class="bdcell 10"><div id="circle0_34" class="normal">N-</div></td><td id="cell0_35" class="bdcell 10"><div id="circle0_35" class="normal">N+</div></td><td id="cell0_36" class="bdcell 10"><div id="circle0_36" class="normal">NEx</div></td><td id="cell0_37" class="bdcell 10"><div id="circle0_37" class="normal">NIn</div></td><td id="cell0_38" class="bdcell 10"><div id="circle0_38" class="normal">C+</div></td><td id="cell0_39" class="bdcell boldRight 10"><div id="circle0_39" class="normal">CIn</div></td><td id="cell0_40" class="bdcell 11"><div id="circle0_40" class="normal">NoP</div></td><td id="cell0_41" class="bdcell 11"><div id="circle0_41" class="normal">P?</div></td><td id="cell0_42" class="bdcell 11"><div id="circle0_42" class="normal">P-</div></td><td id="cell0_43" class="bdcell boldRight 11"><div id="circle0_43" class="normal">P+</div></td><td id="cell0_44" class="bdcell 12"><div id="circle0_44" class="normal">Low</div></td><td id="cell0_45" class="bdcell 12"><div id="circle0_45" class="normal">Ong</div></td><td id="cell0_46" class="bdcell 12"><div id="circle0_46" class="normal">Hi</div></td><td id="cell0_47" class="bdcell boldRight 12"><div id="circle0_47" class="normal">ND</div></td><td id="cell0_48" class="bdcell 13"><div id="circle0_48" class="normal">NoT</div></td><td id="cell0_49" class="bdcell 13"><div id="circle0_49" class="normal">ReT</div></td><td id="cell0_50" class="bdcell boldRight 13"><div id="circle0_50" class="normal">CT</div></td><td id="cell0_51" class="bdcell boldRight 13"><div id="circle0_51" class="normal" style="color: rgb(197, 0, 0); font-size: 16px; text-align: center; width: 120px;"></div></td><td id="cell0_52" class="bdcell boldRight 14"><div id="circle0_52" class="normal" style="color: rgb(197, 0, 0); font-size: 16px; text-align: center;"></div></td><td id="cell0_53" class="bdcell 14"><div id="circle0_53" class="normal" style="color: rgb(197, 0, 0); font-size: 16px; text-align: center;"></div></td><td id="cell0_54" class="bdcell boldRight 14"><div id="circle0_54" class="normal" style="color: rgb(197, 0, 0); font-size: 16px; text-align: center;"></div></td><td id="cell0_55" class="bdcell boldRight 15"><div id="circle0_55" class="normal" style="color: rgb(197, 0, 0); font-size: 16px; text-align: center;"></div></td></tr>
                                </table>
                        </div>

                    </td>
                   <td>
                        <div style="width: 180px; height: calc(-222px + 80vh); overflow: hidden; padding: 0px;">
                            <table width="100%">
                                <tbody>
                                    <tr>
                                        <td style="height: 239px; border-bottom: 1px solid rgb(51, 51, 51);">
                                            &nbsp;
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="height:71px; border-bottom: 3px solid orange;">
                                            &nbsp;
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="height: 71px; border-bottom: 3px solid orange;" align="center">
                                            <button id="save"  style="min-width:30px;">
                                                <span> Save </span>
                                            </button>
                                            <button id="delete" style="min-width:30px;">
                                               <span>Delete</span>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                   </td>
   </div>

<footer class="footer">
        <div class="container-footer">
          <button id="btnNext" class="green right" onclick="location='/';">
            <span>Finish</span>
          </button>
          <!-- createClient(); -->
          <button id="back" class="blue right" onmousedown="previousPage();">
            <span>Back</span>
          </button>
        </div>
      </footer>

</div>

</div>
<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header validHeader">
                <h5 class="modal-title validTitle" id="modal_header">Missing Data</h5>
            </div>
        <div class="modal-body">
        <p style="font-size: 20px; text-align: center;" id="modal_text"></p>
        </div>
        <div class="modal-footer" style="text-align:center;">
                <button type="button" class=" btn-secondary btnDelete" data-dismiss="modal" onclick="callNextPage()">OK</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header deleteHeader">
              <h5 class="modal-title deleteTitle" id="exampleModalLabel">Confirm Action</h5>
            </div>
            <div class="modal-body deleteBody">
                You are about to delete this record. <br>
                Do you want to continue?
            </div>
            <div class="modal-footer" style="text-align:center;">
             <button type="button" class=" btn-secondary btnClose" data-dismiss="modal">Close</button>
              <button type="button" class=" btn-primary btnDelete" onmousedown="deleteRow();">Delete</button>
            </div>
          </div>
        </div>
      </div>
  <div class="popup-overlay">
        <!--Creates the popup content-->
         <div class="popup-content">

         </div>
      </div>
</body>
</html>
<script src="../../../../assets/js/bootstrap/bootstrap.min.js"></script>
<script src="../../../../assets/js/datatables/jquery.dataTables.min.js"></script>
<script src="../../../../assets/js/datatables/dataTables.fixedHeader.min.js"></script>

<script>
  //  addRow();
    var url_string = window.location;
    var url = new URL(url_string);
    locale = "en-us";
    var testing_date = url.searchParams.get("testing_date");
    var retrieve_value = url.searchParams.get("retrieve");
    var entryCode =  url.searchParams.get("entryCode");
    var provider =  url.searchParams.get("provider");
    var testDay, testMonth, testYear;
    var node_age_value, regex, splittedArray, splittedTimeArray, text, num, node_time_value, time_text, time_num,timeValue, ageValue;
    var min,max;
    var hivAccessAnswer, refferedSlipAnswer, hivTestAnswer,clientRiskAnswer, pregnantAnswer,partnerAnswer,partnerStatusAnswer,clientConscentAnswer;
    var ageGroupAnswer, outcomeAnswer, testOne, testTwo, testThree, testFour, resultAnswer, reTestingAnswer;
    var genderAnswer = ' ';
    var new_date, entry_code;
    var modalText = document.getElementById("modal_text");
    var modalHeader = document.getElementById("modal_header");
    //current date
    var dateObj = new Date();
    locale = "en-us";
    var month = dateObj.toLocaleString(locale, { month: "short" });
    var day = dateObj.getUTCDate();
    var year = dateObj.getUTCFullYear();

    if(testing_date == null){
         testDay = day;
         testMonth = month;
         testYear = year;
         new_date = testDay + " " + month + " " + testYear;
    }else{
         testDay = testing_date.split('-')[0];
         testMonth = testing_date.split('-')[1];
         testYear = testing_date.split('-')[2];
        var month = moment().month(testMonth-1).format("MMM");
        new_date = testDay + " " + month + " " + testYear;
    }
    if(retrieve_value == 1){
        retrieveRecord();
    }

    function postHtsVisit() {
        var currentTime = moment().format(' HH:mm:ss');
        var encounter_datetime = node_date;
        encounter_datetime += currentTime;

        var encounter = {
            encounter_type_name: 'HTS Visit',
            encounter_type_id:  163,
            patient_id: sessionStorage.patientID,
            encounter_datetime: encounter_datetime
        };

        submitParameters(encounter, "/encounters", "postHtsVisitObs");
    }
    
    function postHtsVisitObs(encounter){
        var conceptAnswers = [

            /*Access type 0*/
            {
            "pitc": 9429,
            "refferalSlip":9430,
            "other": 6408
            },      
            //1
            {
                "spouse": 5617,
                "parent": 2173,
                "other": 6408
            },
            /*Last HIV Test 2*/
            {
                "neverTested": 9432,
                "lastNegative": 9433,
                "lastPositive": 9434,
                "lastInconclusive": 9436,
                "lastInfant":9435
            },
            /*Client risk 3*/
            {
                "lowRisk": 9437,
                "OngoingRisk": 9749,
                "highRisk": 9438,
                "riskAssess": 9439
            },
            
             /*Partner status 4*/
             {
                "noPartner": 1914,
                "hivUnknown": 9750,
                "partnerNegative": 9751,
                "partnerPositive": 5566           
            }, 
            /*Pregnant 5*/
            {
                "yes": 1065,
                "no": 1066
            },
            /*Sex/Pregnancy 6*/
            {
                "male": 2843,
                "female":2844           
            },  
            /*Age group 7*/
            {
                "elevenMonths": 9769,
                "fourteenYears": 9770,
                "twentyFourYears": 9768,
                "twentyFiveYears": 9771
            }, 
             /*Hiv status 8*/
             {
                "negative": 664,
                "positive": 703
            },
            // Outcome result 9
            {
                "negativeOneTwo": 9781,
                "positiveOneTwo": 9782,
                "discOneTwo": 9780
            },
            // Result  given to client 10
            {
                "newNegative": 9773,
                "newPositive": 9774,
                "newInconclusive": 9775,
                "confPositive": 9776,
                "inconclusive": 9777,
                "newExposedInfant": 9783
            },
            // Refferal re testing 11
            {
                "NoT": 9778,
                "ReT": 9762,
                "CT":7877
            }
        ];

        switch (node_access_type) {
            case 'PITC':
                hivAccessAnswer = conceptAnswers[0].pitc;
                break;
            case 'FRS':
                hivAccessAnswer = conceptAnswers[0].refferalSlip;
                break;
            case 'Oth':
                hivAccessAnswer = conceptAnswers[0].other;
                break;
        }
        switch (node_ltest) {
            case 'LNev':
                hivTestAnswer = conceptAnswers[2].neverTested;
                break;
            case 'L-':
                hivTestAnswer = conceptAnswers[2].lastNegative;
                break;
            case 'L+':
                hivTestAnswer = conceptAnswers[2].lastPositive;
                break;
            case 'LEx':
                hivTestAnswer = conceptAnswers[2].lastInconclusive;
                break;
            case 'LIn':
                hivTestAnswer = conceptAnswers[2].lastInfant;
                break;
        }

        switch (node_client_risk) {
            case 'Low':
                clientRiskAnswer = conceptAnswers[3].lowRisk;
                break;
            case 'Ong':
                clientRiskAnswer = conceptAnswers[3].OngoingRisk;
                break;
            case 'HI':
                clientRiskAnswer = conceptAnswers[3].highRisk;
                break;
            case 'ND':
                clientRiskAnswer = conceptAnswers[3].riskAssess;
            break;
        }
        switch (node_partner_status) {
            case 'NoP':
                partnerStatusAnswer = conceptAnswers[4].noPartner;
                break;
            case 'P?':
                partnerStatusAnswer = conceptAnswers[4].hivUnknown;
                break;
            case 'P-':
                partnerStatusAnswer = conceptAnswers[4].partnerNegative;
                break;
            case 'P+':
                partnerStatusAnswer = conceptAnswers[4].partnerPositive;
                break;
        }

        switch (node_gender) {
            case 'M':
                genderAnswer = conceptAnswers[6].male;
                break;
            case 'FNP':
                genderAnswer = conceptAnswers[6].female;
                pregnantAnswer = conceptAnswers[5].no;
                break;
            case 'FP':
                genderAnswer = conceptAnswers[6].female;
                pregnantAnswer = conceptAnswers[5].yes;
            break;
        }
        switch (node_age_group) {
            case 'A':
                min = 0;
                max = 330;
                ageGroupAnswer = conceptAnswers[7].elevenMonths;
                break;
            case 'B':
                min = 331;
                max = 5110;
                ageGroupAnswer = conceptAnswers[7].fourteenYears;
                break;
            case 'C':
                min = 5111;
                max = 8760;
                ageGroupAnswer = conceptAnswers[7].twentyFourYears;
            break;
            case 'D':
                min = 8761;
                max = 36500;
                ageGroupAnswer = conceptAnswers[7].twentyFiveYears;
                break;
        }

        switch (node_test_one) {
            case '-':
                testOne = conceptAnswers[8].negative;
                break;
            case '+':
                testOne = conceptAnswers[8].positive;
                break;
        }

        switch (node_test_two) {
            case '-':
                testTwo = conceptAnswers[8].negative;
                break;
            case '+':
                testTwo = conceptAnswers[8].positive;
                break;
        } 
        switch (node_test_three) {
            case '-':
                testThree = conceptAnswers[8].negative;
                break;
            case '+':
                testThree = conceptAnswers[8].positive;
                break;
        } 
        
        switch (node_test_four) {
            case '-':
                testFour = conceptAnswers[8].negative;
                break;
            case '+':
                testFour = conceptAnswers[8].positive;
                break;
        } 
        
        switch (outcome_summary) {
            case '+':
                outcomeAnswer = conceptAnswers[8].positive;
                break;
            case '-':
                outcomeAnswer = conceptAnswers[8].negative;
                break;
            case '--':
                outcomeAnswer = conceptAnswers[9].negativeOneTwo;
            break;
            case '++':
                outcomeAnswer = conceptAnswers[9].positiveOneTwo;
                break;
            case 'Disc':
                outcomeAnswer = conceptAnswers[9].discOneTwo;
            break;
        }

        switch (node_result) {
            case 'N-':
                resultAnswer = conceptAnswers[10].newNegative;
                break;
            case 'N+':
                resultAnswer = conceptAnswers[10].newPositive;
                break;
            case 'NEx':
                resultAnswer = conceptAnswers[10].newExposedInfant;
            break;
            case 'NIN':
                resultAnswer = conceptAnswers[10].newInconclusive;
                break;
            case 'C+':
                resultAnswer = conceptAnswers[10].confPositive;
            break;
            case 'CIn':
                resultAnswer = conceptAnswers[10].inconclusive;
            break;
        }
        switch (node_refferal_retesting) {
            case 'NoT':
                reTestingAnswer = conceptAnswers[11].NoT;
                break;
            case 'ReT':
            reTestingAnswer = conceptAnswers[11].ReT;
                break;
            case 'CT':
            reTestingAnswer = conceptAnswers[11].CT;
            break;
        }

        switch (node_partner) {
            case 'NO':
                partnerAnswer = conceptAnswers[5].no;
                break;
            case 'YES':
                partnerAnswer = conceptAnswers[5].yes;
                break;
        }
        var obs = {
            encounter_id: encounter["encounter_id"],
            observations: [
                { concept_id: 8846, value_coded: genderAnswer}, 
                { concept_id: 3467, value_numeric: ageValue}, 
                { concept_id: 9753, value_coded: ageGroupAnswer}, 
                { concept_id: 9428, value_coded: hivAccessAnswer }, 
                { concept_id: 9656, value_coded: hivTestAnswer }, 
                { concept_id: 9765, value_numeric: timeValue }, 
                { concept_id: 9761, value_coded: partnerAnswer}, 
                { concept_id: 9754, value_coded: testOne }, 
                { concept_id: 6538, value_coded: outcomeAnswer}, 
                { concept_id: 9764, value_coded: resultAnswer},
                { concept_id: 3082, value_coded: partnerStatusAnswer},      
                { concept_id: 9427, value_coded: clientRiskAnswer }, 
                { concept_id: 9762, value_coded: reTestingAnswer}, 
                { concept_id: 9758, value_text: node_family_slip.nodeValue }, 
                { concept_id: 7858, value_text: node_male_condom.nodeValue }, 
                { concept_id: 7859, value_text: node_female_condom.nodeValue }
            ]
        };
        if(secondTest != 0) {
            obs.observations.push({ concept_id: 9755, value_coded: testTwo });
        }
        if(thirdTest != 0) {
            obs.observations.push({ concept_id: 9785, value_coded: testThree });
        }
        if(fourthTest != 0) {
            obs.observations.push({ concept_id: 9759, value_coded: testFour });
        }
        if(pregnantAnswer !== '') {
            
            obs.observations.push({ concept_id: 6131, value_coded: pregnantAnswer });
        }
        if(node_appointment.nodeValue  !== '') {
            
            obs.observations.push({ concept_id: 5096, value_text: node_appointment.nodeValue });
        }
        if(node_male_condom.nodeValue  !== ' ') {
            
            obs.observations.push({ concept_id: 7858, value_text: node_male_condom.nodeValue });
        }
        if(node_female_condom.nodeValue  !== ' ') {
            
            obs.observations.push({ concept_id: 7859, value_text: node_female_condom.nodeValue });
        }
        if(node_comment.nodeValue  !== ' ') {
            
            obs.observations.push({ concept_id: 6357, value_text: node_comment.nodeValue });
        }
          submitParameters(obs, "/observations", "getEntryRecord")

    }  

    //Creating encounter inorder to produce unique Visit entry
    function createEncounter(){
        var parameters = {
        encounter_type_id: 163,
        patient_id: sessionStorage.patientID
        };

        var parametersPassed = JSON.stringify(parameters);

            var url = apiProtocol + "://" + apiURL + ":" + apiPort;
 
        url += "/api/v1/encounters";
        var xhttp = new XMLHttpRequest();
        
        xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && (this.status == 201 || this.status == 200)) {
            var obj = JSON.parse(this.responseText);
        }
        };
        
        xhttp.open("POST", url, true);
        
        xhttp.setRequestHeader('Authorization', sessionStorage.getItem("authorization"));
        
        xhttp.setRequestHeader('Content-type', "application/json");
        
        xhttp.send(parametersPassed);
    }

    //Displaying entry code after saving obs

    function getEntryRecord(){
    var parameters = {
    encounter_id: 163
    };

    var parametersPassed = JSON.stringify(parameters);

        var url = apiProtocol + "://" + apiURL + ":" + apiPort;
 
        url += "/api/v1/programs/"+ sessionStorage.programID + "/codes/entry_code";

        var xhttp = new XMLHttpRequest();
        
        xhttp.onreadystatechange = function() {
        
        if (this.readyState == 4 && (this.status == 201 || this.status == 200)) {
            var obj = JSON.parse(this.responseText);
            entry_code = obj['entry_code'];
            modalHeader.innerText =  "Entry code";
            modalText.innerText +=  entry_code;
            $j("#myModal").modal();
                
        }
        
        };
        
        xhttp.open("POST", url, true);
        
        xhttp.setRequestHeader('Authorization', sessionStorage.getItem("authorization"));
        
        xhttp.setRequestHeader('Content-type', "application/json");
        
        xhttp.send(parametersPassed);

    }
    function nextPage(){
        var retrieve = 1;
        window.location.href = "/apps/HTS/views/encounters/backdata2.html?testing_date = "+testing_date+"&retrieve="+retrieve+"&entryCode="+entry_code+"&provider="+node_provider.nodeValue;
    }
    
    function callNextPage(){
        if(modalHeader.innerText ==  "Entry code"){
            nextPage();
        }else{
            $j("#myModal").hide();
        }
    }

</script>
<script>

    jQuery(document).ready(function($){
        $("#save").click(function(){

            var age;
            var count = 0;
            var save = 0;
            modalText.innerHTML = "";      

            switch (node_age_group) {
            case 'A':
                min = 0;
                max = 330;
                break;
            case 'B':
                min = 331;
                max = 5110;
                break;
            case 'C':
                min = 5111;
                max = 8760;
            break;
            case 'D':
                min = 8761;
                max = 36500;
                break;
        }
        if(node_provider.nodeValue == ' '){
            modalText.innerHTML != '' ? modalText.innerText += ",HTS provider ID" 
            : modalText.innerHTML += "HTS provider ID";
            count++;
         }

        if(gen < 1){
            modalText.innerHTML != '' ? modalText.innerText += ",Sex/Pregnancy" 
            : modalText.innerHTML += "Sex/Pregnancy";
            count++;
         }
         if( node_age.nodeValue == ' ')
        {
            modalText.innerHTML != '' ? modalText.innerText += ",Age" 
            : modalText.innerHTML += "Age";
            count++;
        }
        if(ageGroup < 1){
            modalText.innerHTML != '' ? modalText.innerText += ",Age group" 
            : modalText.innerHTML += "Age group";
            count++;
        }
        if(type < 1){
                modalText.innerHTML != '' ? modalText.innerText += ",HTS Access Type" 
                : modalText.innerHTML += "HTS Access Type";
                count++;
         }
         if(hivTest < 1){
               modalText.innerHTML != '' ? modalText.innerText += ",Last HIV Test" 
                : modalText.innerHTML += "Last HIV Test";
                count++;
            }

        if(partnerPresent < 1){
            modalText.innerHTML != '' ? modalText.innerText += ",Partner present" 
                : modalText.innerHTML += "Partner present";
        }
        if(firstTest < 1){
                modalText.innerHTML != '' ? modalText.innerText += ",Test 1 result" 
                : modalText.innerHTML += "Test 1 result";
                count++;
        }
        if(outSummary < 1){
            modalText.innerHTML != '' ? modalText.innerText += ",Outcome summary" 
                : modalText.innerHTML += "Outcome summary";
                count++;
            }
        if(resultGiven < 1){
            modalText.innerHTML != '' ? modalText.innerText += ", Result given to client" 
                : modalText.innerHTML += " Result given to client";
                count++;
        }
        //Partner status
        if(client < 1){
            modalText.innerHTML != '' ? modalText.innerText += ",Client Risk Category" 
                : modalText.innerHTML += "Client Risk Category";
                count++;
            } 
        if(retesting < 1){
            modalText.innerHTML != '' ? modalText.innerText += ",Referral for Re-Testing" 
                : modalText.innerHTML += "Referral for Re-Testing";
                count++;
        }

        if(count >= 1){
            modalText.innerHTML += " must be entered";
            $("#myModal").modal();
            save++;
        }else
         if(count==0){
             
            node_age_value = node_age.nodeValue;
            regex = new RegExp('([0-9]+)|([WDMY]+)','g');
            splittedArray = node_age_value.match(regex);

            text = splittedArray[1];
            num = splittedArray[0];
            switch (text) {
                case 'W':
                if(num > 1 && num <= 26){
                    ageValue = num + " Weeks";
                    age = num*7;
                }else{
                    modalText.innerHTML = "Number of weeks between 1 and 26 must be entered";
                    $("#myModal").modal();
                    save++;
                }           
                    break;
                case 'D':
                    if(num > 1 && num <= 30){
                        ageValue = num + " Days";
                        age = num*1;
                    }else{
                        modalText.innerHTML = "Number of days between 1 and 30 must be entered";
                        $("#myModal").modal();
                        save++;
                    }             
                    break;
                case 'M':
                    if(num > 1 && num <= 36){
                    ageValue = num + " Months";
                    age = num*30;
                    }else{
                        modalText.innerHTML = "Number of months between 1 and 36 must be entered";
                        $("#myModal").modal();
                        save++;
                    }   
                break;
                case 'Y':
                    if(num > 1 && num <= 110){
                        ageValue = num;
                        age = num*365;
                    }else{
                        modalText.innerHTML = "Number of years between 1 and 110 must be entered";
                        $("#myModal").modal();
                        save++;
                    }
                  break;
                default:
                    
                     modalText.innerHTML = "Missing Units for Age";
                    $("#myModal").modal();
                    save++;
                break;
        }
            if (age < min || age > max) {
                modalText.innerHTML = "Age group does not match entered age";
                $("#myModal").modal();
                save++;
            }
            node_time_value = node_time.nodeValue;
            if(age >= 14){
                if( node_female_condom.nodeValue == ' ')
                    {
                        modalText.innerHTML != 'Female condoms must be entered'
                    }
                if( node_male_condom.nodeValue == ' ')
                {
                    modalText.innerHTML != 'Male condoms must be entered'
                }
            }
            if(node_ltest != "LNev"){
                if(node_time_value == ' '){
                    modalText.innerHTML = "Time since last test must be entered";
                    $("#myModal").modal();
                    save++;
                }else{
                splittedTimeArray = node_time_value.match(regex);
                time_text = splittedTimeArray[1];
                time_num = splittedTimeArray[0];
                switch (time_text) {
                    case 'W':
                        timeValue = Math.round(time_num/52);            
                        break;
                    case 'D':
                        timeValue = Math.round(time_num/365);
                        break;
                    case 'M':
                    timeValue =  Math.round(time_num/12);
                    break;
                    case 'Y':
                        timeValue = time_num;
                        break;
                    default:
                        modalText.innerHTML = "Expecting Time Since Last Test to be a number with a unit";
                        $("#myModal").modal();
                        save++;
                    break;
                }
            }
            }else{
                if(node_time_value != ' '){
                    modalHeader.innerHTML = "Invalid Entry";
                    modalText.innerHTML = "Time Since Last Test must NOT be entered if never tested";
                    $("#myModal").modal();
                    save++;
                }
            } 
            if(node_refferal_retesting == "ReT" || node_refferal_retesting == "CT"){
                if(node_appointment.nodeValue == ' '){
                    modalText.innerHTML = "Appointment date must be entered";
                    $("#myModal").modal();
                    save++;
                }else{
                    if(node_refferal_retesting == "ReT"){
                        var weekDate = new Date(testYear, testMonth, testDay); 
                        weekDate.toDateString();
                        weekDate.setDate(weekDate.getDate() + 7);

                        var yearDate = new Date(testYear, testMonth, testDay); 
                        yearDate.toDateString();
                        yearDate.setDate(yearDate.getDate() + 365);

                        var appointmentDate = moment(node_appointment.nodeValue);
                        var nextWeek = moment(weekDate);
                        var nextYear = moment(yearDate);
            
                        if (!appointmentDate.isBetween(nextWeek, nextYear)) {
                            modalText.innerHTML = "Appointment date for re-test must be between 1 week and 1 year from current test date.";
                            $("#myModal").modal();
                            save++;
                        }
                    }else if(node_refferal_retesting == "CT"){
                        var threeMonthDate = moment(testing_date, 'DD-MM-YYYY').add('month', 3)

                        var appointmentDate = moment(node_appointment.nodeValue);
                        var nextThreeMonth = moment(threeMonthDate);
                        var testDate = moment(testing_date);
                        if (!appointmentDate.isBetween(testDate, nextThreeMonth)) {
                            modalText.innerHTML = "Appointment date for confirmatory test must be between same day and 3 months from current test date.";
                            $("#myModal").modal();
                            save++;
                        }
                    }
                }
                var FRS = node_family_slip.nodeValue;
                if (FRS == ' '){
                    modalText.innerHTML = "Number of FRS given must be entered";
                    $("#myModal").modal();
                    save++;
                }else if(FRS < 0 || FRS > 15){
                    modalText.innerHTML = "Number of FRS given should be 0 - 15";
                    $("#myModal").modal();
                    save++;
                }
                var maleCondoms = node_male_condom.nodeValue;
                var femaleCondoms = node_female_condom.nodeValue;
                if( maleCondoms == ' ' ){
                    modalText.innerHTML = "Number of male condoms given must be entered";
                    $("#myModal").modal();
                } else if(maleCondoms < 0 || maleCondoms > 500){
                    modalText.innerHTML = "Number of male condoms given should be 0 - 500";
                    $("#myModal").modal();
                }

                if( femaleCondoms == ' ' ){
                    modalText.innerHTML = "Number of female condoms given must be entered";
                    $("#myModal").modal();
                }else if(femaleCondoms < 0 || femaleCondoms > 500){
                    modalText.innerHTML = "Number of female condoms given should be 0 - 500";
                    $("#myModal").modal();
                }
            }
            if(node_test_one != "-" ){
                if(secondTest < 1){
                        modalText.innerHTML = "HIV Rapid Test Outcomes must be entered";
                        $("#myModal").modal();
                        save++;
                    }
            }else 
            if((node_test_one == "-" && node_test_two == "+") || (node_test_one == "+" && node_test_two == "-")){
                thirdTest < 1  ? (
                        modalText.innerHTML = "Confirmation tests must be entered",
                    $("#myModal").modal()
                    ) : (
                        node_test_one = node_test_three
                    );

                    fourthTest < 1 ? (
                        modalText.innerHTML = "HIV Rapid Test Outcomes must be entered",
                        $("#myModal").modal()
                        
                    ) : (
                        node_test_two = node_test_four
                    );
            
                }


            if(node_test_one == "-" && secondTest < 1){
                if(node_outcome =! "-"){
                    modalHeader.innerHTML = "Invalid Entry";
                        modalText.innerHTML = "Outcome summary does not match Test 1 / Test 2 results";
                        $("#myModal").modal();
                        save++;
                }
            }else  if(node_test_one == "+" && secondTest < 1){
                if(node_outcome =! "+"){
                    modalHeader.innerHTML = "Invalid Entry";
                        modalText.innerHTML = "Outcome summary does not match Test 1 / Test 2 results";
                        $("#myModal").modal();
                        save++;
                }
            }else  if(node_test_one == "-" && node_test_two == "-"){
                if(node_outcome =! "--"){
                    modalHeader.innerHTML = "Invalid Entry";
                        modalText.innerHTML = "Outcome summary does not match Test 1 / Test 2 results";
                        $("#myModal").modal();
                        save++;
            }
            }else  if(node_test_one == "+" && node_test_two == "+"){
                if(node_outcome =! "++"){
                    modalHeader.innerHTML = "Invalid Entry";
                        modalText.innerHTML = "Outcome summary does not match Test 1 / Test 2 results";
                        $("#myModal").modal();
                        save++;

            }}else  if((node_test_one == "-" && node_test_two == "+") || (node_test_one == "+" && node_test_two == "-")){
                if(node_outcome =! "Disc"){
                    modalHeader.innerHTML = "Invalid Entry";
                        modalText.innerHTML = "Outcome summary does not match Test 1 / Test 2 results";
                        $("#myModal").modal();
                        save++;
            }
            }
            if(node_ltest == 'LNev' || node_ltest == 'L-'){
                if((node_test_one == "-")  || (node_test_one == "-" && node_test_two == "-")){
                    if(node_result != "N-"){
                        modalHeader.innerHTML = "Invalid Entry";
                        modalText.innerHTML = "Result given to client must be New Negative";
                        $("#myModal").modal();
                        save++;
                    }
                }
                if(node_test_one == "+" && node_test_two == "+"){
                    if(age < 330 ){
                        if(node_result != "NEx"){
                        modalHeader.innerHTML = "Invalid Entry";
                        modalText.innerHTML = "Result given to client must be New Exposed Infant";
                        $("#myModal").modal();
                        save++;
                        }
                    }else if(age > 330){
                        if(node_result != "N+"){
                        modalHeader.innerHTML = "Invalid Entry";
                        modalText.innerHTML = "Result given to client must be New Positive";
                        $("#myModal").modal();
                        save++;
                        }
                    }   
                    }
                    if((node_test_one == "-" && node_test_two == "+") || (node_test_one == "+" && node_test_two == "-")){
                        if(node_result != "NIN"){
                        modalHeader.innerHTML = "Invalid Entry";
                        modalText.innerHTML = "Result given to client must be New Inconclusive";
                        $("#myModal").modal();
                        save++;
                        }       
                    }

                }
                if(node_ltest == "L+"){
                    if(node_test_one == "+" && node_test_two == "+"){
                    if(age < 330 ){
                    if(node_result != "NEx"){
                    modalHeader.innerHTML = "Invalid Entry";
                    modalText.innerHTML = "Result given to client must be New Exposed Infant";
                    $("#myModal").modal();
                    save++;
                    }
                }else if(age > 330){
                    if(node_result != "C+"){
                    modalHeader.innerHTML = "Invalid Entry";
                    modalText.innerHTML = "Result given to client must be Confirmed Positive";
                    $("#myModal").modal();
                    save++;
                }
                }else   
                if(node_test_one == "-" && node_test_two == "-"){
                    if(node_result != "CIn"){
                    modalHeader.innerHTML = "Invalid Entry";
                    modalText.innerHTML = "Result given to client must be Confirmed Inconclusive";
                    $("#myModal").modal();
                    save++;
                         }
                }
                else 
                if((node_test_one == "-" && node_test_two == "+") || (node_test_one == "+" && node_test_two == "-")){
                    if(node_result != "CIn"){
                    modalHeader.innerHTML = "Invalid Entry";
                    modalText.innerHTML = "Result given to client must be Confirmed Inconclusive";
                    $("#myModal").modal();
                    save++;
                    }       
                }
             }
         }

         if(node_ltest == "LIn"){
            if(node_test_one == "-" && node_test_two == "-"){
                    if(node_result != "N-"){
                    modalHeader.innerHTML = "Invalid Entry";
                    modalText.innerHTML = "Invalid Result Given to Client";
                    $("#myModal").modal();
                    save++;
                    }
            }else  if(node_test_one == "+" && node_test_two == "+"){
                if(age < 330 ){
                    if(node_result != "NEx"){
                    modalHeader.innerHTML = "Invalid Entry";
                    modalText.innerHTML = "Combination of test results is not plausible";
                    $("#myModal").modal();
                    save++;
                    }
                }else if(age > 330){
                    if(node_result != "N+"){
                    modalHeader.innerHTML = "Invalid Entry";
                    modalText.innerHTML = "Combination of test results is not plausible";
                    $("#myModal").modal();
                    save++;
                }
            }
           }else if((node_test_one == "-" && node_test_two == "+") || (node_test_one == "+" && node_test_two == "-")){
                    if(node_result != "NIN"){
                    modalHeader.innerHTML = "Invalid Entry";
                    modalText.innerHTML = "Combination of test results is not plausible";
                    $("#myModal").modal();
                    save++;
                    }       
            }
         }
         if(node_client_risk == "Low"){
                if(node_refferal_retesting != "NoT"){
                    modalHeader.innerHTML = "Invalid Entry";
                     modalText.innerHTML = "Combination of test results is not plausible";
                     $("#myModal").modal();
                     save++;
                }
               
        }
        }
        
        if(save == 0){
           createClient();
        }
    
    });
      $("#delete").click(function(){
            $("#deleteModal").modal();
 
      });
      
    });

    function deleteRow(){
            $j('#backdata tr:last').remove();
            addRow();
            $j('#deleteModal').modal('hide');
        }
 </script>